<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>{{ blog_title }}</title>
        <meta name="description" content="A chapter for a book that'll never exist.">
        <meta name="author" content="K Lars Lohn">
        <meta name="robots" content="noindex">
        <link rel="stylesheet" href="../gf4ulgcxmm/style.css" />
    </head>
    <body>
        <img class="header-image" src="{{ blog_header_url or "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhz-_-xY83xHIQA7sf3HX1uqgMwouQIgF5l1l8WwZV6n1-mQgBxoaWFfWjdj8KELI9yyNb9GGlb5bb7dfUt3-xAJHSCvmMfNp3VvT8N_b0tUVz1T4TE9o36O7dbKZ8cust1SJKa_JXtttgHjoKra2jtFBuifAgCYUiMk7l4O8zzPAkmtSe3o42iTg/s1600/dead-of-winter.png" }}"/>
        
        <div class="top-bar">
            <div class="title"><a href="https://twobraids.com">twobraids</a></div>
        </div>
    
        <div class="content">
            <h1>{{ blog_title }}</h1>
    
        
            <div class="lars-nav-section">
                <div class="lars-nav-newer">
                {% if prev %}
                    <a href="{{ prev.blog_relative_url }}#top">&#9668; Story Arc Backward</a><br />
                {% else %}
                    <span class="lars-nav-not-written">&#9668; Story Arc Backward</span><br />
                {% endif %}
                </div>
                <div class="lars-nav-center">
                    <a href="{{ contents_relative_url }}">Going to the Sun - Contents</a>
                </div>
                <div class="lars-nav-older">
                {% if next %}
                    <a href="{{ next.blog_relative_url }}#top">Story Arc Forward &#9658;</a><br />
                {% else %}
                    <span class="lars-nav-not-written">Story Arc Forward &#9658;</span><br />
                {% endif %}
                </div>
            </div>
            
            <p>&nbsp;</p>
            
            <div class="lars-inner-box">
                {% if blog_author_note %}
                  <p><strong>Author's Note:</strong></p>
                  <p>{{ blog_author_note }}</p>
                {% endif %}
                {% if blog_publish_date %}
                  <p>Original Post: {{ blog_publish_date }}<br />
                  Latest Update: {{ blog_update_date }}</i></p>
                {% endif %}
                {% if blog_long_warning or blog_short_warning %}
                  <p> <span class="yellow"><strong>CONTENT WARNING</strong></span><br />
                  {{ blog_long_warning or blog_short_warning }}</p>
                {% endif %}
                {% if blog_author_note and "placeholder" in blog_author_note %}
                  <p class="green"><a href="{{ next.blog_relative_url }}#top">Skip to the next chapter &#9658;</a></p>
                {% endif %}
                {% if blog_updates_present %}
                  <p>The symbol <b><span id="Ustart" class=orange>&#x25CF;</span></b> indicates an <br />
                  updated paragraph within the last 10 days.<br />
                  The darker the symbol, the older the update.</p>
                {% endif %} 
            </div>
                  
            {{ content_html }}
            
            {% if blog_author_note and "placeholder" in blog_author_note %}
            {% else %}
                <div class="lars-nav-section">
                    <div class="lars-nav-newer">
                    {% if prev %}
                        <a href="{{ prev.blog_relative_url }}#top">&#9668; Story Arc Backward</a><br />
                    {% else %}
                        <span class="lars-nav-not-written">&#9668; Story Arc Backward</span><br />
                    {% endif %}
                    </div>
                    <div class="lars-nav-center">
                        <a href="{{ contents_relative_url }}">Going to the Sun - Contents</a>
                    </div>
                    <div class="lars-nav-older">
                    {% if next %}
                        <a href="{{ next.blog_relative_url }}#top">Story Arc Forward &#9658;</a><br />
                    {% else %}
                        <span class="lars-nav-not-written">Story Arc Forward &#9658;</span><br />
                    {% endif %}
                    </div>
                </div>
            {% endif %}
            
            <div class="lars-inner-box">
              <p>This is a work of fiction based on experiences from my life.</p>
              <p>©2025 by K Lars Lohn All rights reserved</p>
              <iframe src="https://www.twobraids.com/p/chapter.html" width="1" height="1" style="border:0; visibility:hidden;"></iframe>
            </div>
            
        </div>
{% if blog_updates_present %}
<script>
  // --- CONFIGURATION ---
  // You can adjust these values to change the scrolling behavior.
  const CONFIG = {
    // The unique ID for the introductory dot.
    headerDotId: 'Ustart',
    // Scroll animation duration in milliseconds.
    scrollDuration: 800,
    // Time in milliseconds to detect a double click/tap.
    doubleClickDelay: 300,
    // The final position for the first dot, in pixels from the top of the window.
    // This is used only when clicking the introductory dot.
    topOffsetPixels: 100,
  };

  // Switched to the 'load' event to ensure all page assets (images, fonts)
  // are loaded. This provides stable element positions for accurate scrolling.
  window.addEventListener('load', () => {
    // --- ELEMENT DISCOVERY ---
    const headerDot = document.getElementById(CONFIG.headerDotId);
    const contentDots = Array.from(document.querySelectorAll('span[id^="U"]')).sort((a, b) => {
      const numA = parseInt(a.id.substring(1), 10);
      const numB = parseInt(b.id.substring(1), 10);
      return numA - numB;
    });

    if (!contentDots.length) return;

    const allDots = headerDot ? [headerDot, ...contentDots] : [...contentDots];

    // --- CORE SCROLLING FUNCTION ---
    const smoothScrollTo = (targetElement, finalPosition) => {
      const startY = window.scrollY;
      const targetY = targetElement.getBoundingClientRect().top + startY - finalPosition;
      const distance = targetY - startY;
      let startTime = null;

      const easeInOutQuad = (t, b, c, d) => {
        t /= d / 2;
        if (t < 1) return c / 2 * t * t + b;
        t--;
        return -c / 2 * (t * (t - 2) - 1) + b;
      };

      const animation = (currentTime) => {
        if (startTime === null) startTime = currentTime;
        const timeElapsed = currentTime - startTime;
        const run = easeInOutQuad(timeElapsed, startY, distance, CONFIG.scrollDuration);
        window.scrollTo(0, run);
        if (timeElapsed < CONFIG.scrollDuration) {
          requestAnimationFrame(animation);
        }
      };
      requestAnimationFrame(animation);
    };

    // --- SCROLL HANDLERS ---
    const handleForwardScroll = (dot) => {
      const currentDotIndex = contentDots.indexOf(dot);
      const isHeader = (dot.id === CONFIG.headerDotId);
      
      let targetDot;
      if (isHeader) {
         targetDot = contentDots[0];
      } else if (currentDotIndex === contentDots.length - 1) {
        targetDot = contentDots[0]; // Loop from last to first
      } else {
        targetDot = contentDots[currentDotIndex + 1];
      }

      const finalPosition = isHeader ? CONFIG.topOffsetPixels : dot.getBoundingClientRect().top;
      smoothScrollTo(targetDot, finalPosition);
    };

    const handleReverseScroll = (dot) => {
      const currentDotIndex = contentDots.indexOf(dot);
      const isHeader = (dot.id === CONFIG.headerDotId);
      
      let targetDot;
      if (isHeader || currentDotIndex === 0) {
        targetDot = contentDots[contentDots.length - 1]; // Loop from first to last
      } else {
        targetDot = contentDots[currentDotIndex - 1];
      }
      
      const clickPosition = dot.getBoundingClientRect().top;
      smoothScrollTo(targetDot, clickPosition);
    };

    // --- EVENT LISTENER ATTACHMENT ---
    allDots.forEach(dot => {
      let clickTimer = null;

      // The 'click' event handles both mouse clicks and mobile taps.
      dot.addEventListener('click', (e) => {
        e.preventDefault(); // Prevents text selection on double click

        // If a timer is running, this is a double click.
        if (clickTimer) {
          clearTimeout(clickTimer);
          clickTimer = null;
          handleReverseScroll(dot); // ⏪ Double-click scrolls backward
        } else {
          // On the first click, set a timer.
          clickTimer = setTimeout(() => {
            clickTimer = null;
            handleForwardScroll(dot); // ⏩ Single-click scrolls forward
          }, CONFIG.doubleClickDelay);
        }
      });
    });
  });
</script>

{% endif %}

    </body>

<html>
